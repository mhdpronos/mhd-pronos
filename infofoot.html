<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Info Foot — MHD PRONOS</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root{
      --bg:#0b0e14; --panel:#121826; --muted:#a3aed0; --violet:#7c5cff; --green:#16c784; --red:#ff4d4d; --blue:#3b82f6;
    }
    body{background: radial-gradient(1200px 600px at 20% 0%, rgba(124,92,255,.15), transparent 40%), var(--bg); color:#fff;}
    .glass{background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03)); border:1px solid rgba(255,255,255,.08); box-shadow: 0 10px 40px rgba(0,0,0,.35);}
    .pill{border:1px solid rgba(255,255,255,.15); background: rgba(255,255,255,.06);}
    .chip{border:1px solid rgba(255,255,255,.12); background: rgba(255,255,255,.05); transition:.2s}
    .chip.active{border-color:var(--violet); box-shadow: 0 0 0 3px rgba(124,92,255,.25) inset; color:#fff;}
    .card-anim{transition: transform .25s ease, box-shadow .25s ease;}
    .card-anim:hover{transform:translateY(-3px); box-shadow:0 12px 40px rgba(0,0,0,.45);}
    .fade-in{animation:fade .35s ease both;}
    @keyframes fade{from{opacity:0; transform:translateY(6px)} to{opacity:1; transform:translateY(0)}}
    .badge-cat{font-size:.7rem; padding:.18rem .5rem; border-radius:999px; border:1px solid rgba(255,255,255,.15); background:rgba(255,255,255,.08)}
    .partner-btn{display:inline-block; padding:.6rem 1.2rem; border-radius:999px; font-weight:700; background:linear-gradient(135deg,#6366F1,#8B5CF6); border:1px solid rgba(255,255,255,.12); transition:.2s}
    .partner-btn:hover{opacity:.92; transform:translateY(-1px)}
    .btn-primary{background:linear-gradient(135deg,#6366F1,#8B5CF6); border:1px solid rgba(255,255,255,.12);}
    .btn-primary:hover{opacity:.95}
    .modal{position:fixed; inset:0; display:none; place-items:center; background:rgba(0,0,0,.6); z-index:50}
    .modal.open{display:grid}
  </style>
</head>
<body class="min-h-screen">
  <!-- Header -->
  <header class="max-w-6xl mx-auto px-4 pt-6 pb-3">
    <div class="flex items-center justify-between">
      <div class="flex items-center gap-3">
        <img src="logo.JPG" alt="MHD PRONOS" class="w-10 h-10 rounded-full object-cover ring-2 ring-white/10">
        <div>
          <h1 class="text-2xl md:text-3xl font-extrabold tracking-tight">FOOT NEWS</h1>
          <p class="text-sm text-white/60 -mt-0.5">Actus & analyses — publications en temps réel depuis Firebase.</p>
        </div>
      </div>
      <nav class="hidden md:flex items-center gap-2">
        <a href="home.html" class="pill px-4 py-2 rounded-xl hover:opacity-90">Accueil</a>
        <a href="plan abonnement.html" class="pill px-4 py-2 rounded-xl hover:opacity-90">Abonnements</a>
        <a href="notifications.html" class="pill px-4 py-2 rounded-xl hover:opacity-90">Notifications</a>
      </nav>
    </div>
  </header>

  <main class="max-w-6xl mx-auto px-4 pb-24">
    <!-- Filtres -->
    <div class="glass rounded-2xl p-3 md:p-4 mb-6">
      <div class="flex flex-wrap items-center gap-2">
        <button class="chip active px-3 py-1.5 rounded-full text-sm" data-cat="ALL">Tous</button>
        <button class="chip px-3 py-1.5 rounded-full text-sm" data-cat="Mercato">Mercato</button>
        <button class="chip px-3 py-1.5 rounded-full text-sm" data-cat="Résultats">Résultats</button>
        <button class="chip px-3 py-1.5 rounded-full text-sm" data-cat="Blessures">Blessures</button>
        <button class="chip px-3 py-1.5 rounded-full text-sm" data-cat="Afrique">Afrique</button>
        <button class="chip px-3 py-1.5 rounded-full text-sm" data-cat="Europe">Europe</button>
        <div class="ml-auto flex items-center gap-2">
          <button id="markAllRead" class="px-3 py-1.5 rounded-xl text-sm btn-primary">Marquer tout comme lu</button>
        </div>
      </div>
    </div>

    <section id="newsList" class="grid sm:grid-cols-2 lg:grid-cols-3 gap-5"></section>
  </main>

  <!-- Modal -->
  <div id="modal" class="modal">
    <div class="glass rounded-2xl p-0 w-[95%] max-w-2xl overflow-hidden">
      <div class="flex items-center justify-between p-4 border-b border-white/10">
        <div>
          <h3 id="mTitle" class="text-xl font-bold"></h3>
          <div class="text-xs text-white/60" id="mMeta"></div>
        </div>
        <button id="mClose" class="pill px-3 py-1.5 rounded-lg">Fermer</button>
      </div>
      <div class="p-4">
        <img id="mImg" class="w-full max-h-80 object-cover rounded-xl mb-4 hidden" alt="">
        <div id="mBody" class="text-sm leading-relaxed whitespace-pre-wrap"></div>
      </div>
    </div>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getFirestore, collection, query, orderBy, onSnapshot } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCoR8lWMJbB0Pgr-F86v3hwWlX4XT3TQ1k",
      authDomain: "mhd-pronos.firebaseapp.com",
      projectId: "mhd-pronos",
      storageBucket: "mhd-pronos.appspot.com",
      messagingSenderId: "366441954219",
      appId: "1:366441954219:web:a8be6641c5c922c59cf0ee"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    const colRef = collection(db, "infofoot");
    const q = query(colRef, orderBy("publishedAt", "desc"));
    const $list = document.getElementById("newsList");

    let allDocs = [];
    let currentCat = "ALL";

    const fmtDate = ts => {
      if (!ts) return "";
      const d = ts.toDate ? ts.toDate() : new Date(ts);
      return d.toLocaleString("fr-FR");
    };

    function render(){
      const rows = currentCat==="ALL" ? allDocs : allDocs.filter(d => (d.category||"") === currentCat);
      if (rows.length === 0){
        $list.innerHTML = `<div class='col-span-full glass rounded-2xl p-6 text-center text-sm text-white/70'>Aucune info disponible.</div>`;
        return;
      }
      $list.innerHTML = rows.map(d => `
        <article class="glass rounded-2xl p-3 card-anim fade-in">
          <div class="relative">
            ${d.imageUrl ? `<img src="${d.imageUrl}" class="w-full h-44 object-cover rounded-xl mb-3">`
                          : `<div class="w-full h-44 rounded-xl mb-3 bg-gray-800"></div>`}
            <span class="badge-cat absolute top-2 left-2">${d.category || "Info"}</span>
          </div>
          <h4 class="font-bold text-lg leading-tight">${d.title || "(Sans titre)"}</h4>
          <div class="text-xs text-white/60 mt-1">${fmtDate(d.publishedAt)}</div>
          <p class="text-sm text-white/80 mt-2">${(d.body || "").slice(0,140)}...</p>
          <button class="mt-3 px-3 py-1.5 rounded-xl text-sm btn-primary" onclick="openModal('${d.id}')">Lire</button>
        </article>
      `).join("");
    }

    window.openModal = id => {
      const d = allDocs.find(x => x.id === id);
      if (!d) return;
      document.getElementById("mTitle").textContent = d.title;
      document.getElementById("mMeta").textContent = `${d.category || "Info"} • ${fmtDate(d.publishedAt)}`;
      const img = document.getElementById("mImg");
      if (d.imageUrl){ img.src = d.imageUrl; img.classList.remove("hidden"); }
      else img.classList.add("hidden");
      document.getElementById("mBody").textContent = d.body || "";
      document.getElementById("modal").classList.add("open");
    };

    document.getElementById("mClose").addEventListener("click",()=>document.getElementById("modal").classList.remove("open"));
    document.getElementById("modal").addEventListener("click",e=>{if(e.target.id==="modal")document.getElementById("modal").classList.remove("open")});

    document.querySelectorAll("[data-cat]").forEach(btn=>{
      btn.addEventListener("click",()=>{
        document.querySelectorAll(".chip").forEach(x=>x.classList.remove("active"));
        btn.classList.add("active");
        currentCat = btn.getAttribute("data-cat");
        render();
      });
    });

    onSnapshot(q, snap=>{
      allDocs = snap.docs.map(d=>({id:d.id, ...d.data()}));
      render();
    });
  </script>
</body>
</html>
