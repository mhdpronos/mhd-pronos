<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Matchs en direct ‚Äî MHD Pronos</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root{
      --bg:#0b0e14; --panel:#121826; --muted:#a3aed0; --violet:#7c5cff; --green:#16c784; --red:#ff4d4d; --blue:#3b82f6;
    }
    body{background: radial-gradient(1200px 600px at 20% 0%, rgba(124,92,255,.15), transparent 40%), var(--bg); color:#fff;}
    .glass{background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03)); border:1px solid rgba(255,255,255,.08); box-shadow: 0 10px 40px rgba(0,0,0,.35);}
    .pill{border:1px solid rgba(255,255,255,.15); background: rgba(255,255,255,.06);}
    .pill.active{border-color:var(--violet); box-shadow: 0 0 0 3px rgba(124,92,255,.25) inset; color:#fff;}
    .tab-btn{border:1px solid rgba(255,255,255,.14); background: rgba(255,255,255,.05); transition:.2s}
    .tab-btn.active{background: var(--violet); border-color:transparent;}
    .table-wrap{overflow-x:auto}
    .badge{font-size:.75rem; padding:.2rem .5rem; border-radius:999px;}
    .badge.live{background:rgba(255,77,77,.15); color:#ffb3b3; border:1px solid rgba(255,77,77,.35)}
    .badge.soon{background:rgba(60,167,255,.12); color:#b9dcff; border:1px solid rgba(60,167,255,.35)}
    .badge.done{background:rgba(22,199,132,.12); color:#9bf0c9; border:1px solid rgba(22,199,132,.35)}
  </style>
</head>
<body class="min-h-screen">

<header class="max-w-6xl mx-auto px-4 pt-6 pb-3">
  <div class="flex items-center justify-between">
    <div class="flex items-center gap-3">
      <img src="logo.JPG" alt="MHD" class="w-10 h-10 rounded-full object-cover ring-2 ring-white/10">
      <div>
        <h1 class="text-2xl md:text-3xl font-extrabold tracking-tight">Matchs en direct</h1>
        <p class="text-sm text-white/60 -mt-0.5">LDC, Premier League, LaLiga, Bundesliga, Ligue 1 ‚Äì mis √† jour en temps r√©el.</p>
      </div>
    </div>
    <a href="home.html" class="pill px-4 py-2 rounded-xl hover:opacity-90">üè† Accueil</a>
  </div>
</header>

<main class="max-w-6xl mx-auto px-4 pb-24">
  <div class="glass rounded-2xl p-3 md:p-4 mb-4 flex flex-wrap gap-2">
    <button data-tab="live" class="tab-btn active px-4 py-2 rounded-xl font-semibold">En cours ‚ö°</button>
    <button data-tab="upcoming" class="tab-btn px-4 py-2 rounded-xl font-semibold">√Ä venir üïí</button>
    <button data-tab="finished" class="tab-btn px-4 py-2 rounded-xl font-semibold">Termin√©s üî¥</button>
    <div class="ml-auto text-xs text-white/60">MAJ auto <span id="refreshIn">20s</span></div>
  </div>

  <section id="matchContainer" class="space-y-4"></section>
</main>

<script>
const PROXY_URL = "https://mhdpronos.com/proxy.php";

async function getMatches(endpoint){
  try {
    const res = await fetch(`${PROXY_URL}?endpoint=${endpoint}`);
    if(!res.ok) throw new Error("Erreur HTTP " + res.status);
    const data = await res.json();
    if(!data || !data.data || !data.data.length) {
      document.getElementById("matchContainer").innerHTML = `
        <div class="glass rounded-xl p-5 text-center text-gray-400">Aucun match √† afficher pour cet onglet.</div>`;
      return [];
    }
    return data.data;
  } catch(e){
    document.getElementById("matchContainer").innerHTML = `
      <div class="glass rounded-xl p-5 text-center text-red-400">‚ùå Erreur de chargement : ${e.message}</div>`;
    return [];
  }
}

function renderMatch(m){
  const league = m.league?.name ?? "Comp√©tition";
  const home = m.participants?.find(p => p.meta?.location === "home")?.name ?? "√âquipe A";
  const away = m.participants?.find(p => p.meta?.location === "away")?.name ?? "√âquipe B";
  const homeLogo = m.participants?.find(p => p.meta?.location === "home")?.image_path ?? "";
  const awayLogo = m.participants?.find(p => p.meta?.location === "away")?.image_path ?? "";
  const hs = m.scores?.find(s => s.description === "CURRENT")?.score?.home ?? 0;
  const as = m.scores?.find(s => s.description === "CURRENT")?.score?.away ?? 0;
  const status = m.state?.name ?? "√† venir";
  const start = new Date(m.starting_at).toLocaleString("fr-FR", { hour: '2-digit', minute: '2-digit', day: '2-digit', month: 'short' });

  return `
  <div class="glass rounded-xl p-4 border border-white/10 flex items-center justify-between gap-4">
    <div class="flex items-center gap-3 w-1/3">
      <img src="${homeLogo}" class="w-7 h-7 rounded-full"> <span>${home}</span>
    </div>
    <div class="text-center w-1/3">
      <div class="font-bold text-lg">${hs} : ${as}</div>
      <div class="text-xs text-gray-400">${status}</div>
      <div class="text-xs">${league}</div>
    </div>
    <div class="flex items-center gap-3 justify-end w-1/3">
      <span>${away}</span> <img src="${awayLogo}" class="w-7 h-7 rounded-full">
    </div>
  </div>`;
}

async function loadTab(tab){
  let endpoint = "";
  if(tab === "live") endpoint = "livescores";
  if(tab === "upcoming") endpoint = "fixtures/date/today";
  if(tab === "finished") endpoint = "fixtures/date/yesterday";

  const matches = await getMatches(endpoint);
  document.getElementById("matchContainer").innerHTML = matches.map(renderMatch).join("");
}

document.querySelectorAll("[data-tab]").forEach(btn=>{
  btn.addEventListener("click",()=>{
    document.querySelectorAll("[data-tab]").forEach(b=>b.classList.remove("active"));
    btn.classList.add("active");
    loadTab(btn.dataset.tab);
  });
});

loadTab("live");
setInterval(()=>loadTab(document.querySelector("[data-tab].active")?.dataset.tab || "live"), 30000);
</script>

</body>
</html>
