<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Profil — MHD PRONOS</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root {
      --bg: #0b0e14;
      --panel: #121826;
      --violet: #7c5cff;
      --green: #16c784;
      --red: #ff4d4d;
    }
    body {
      background: radial-gradient(1200px 600px at 20% 0%, rgba(124,92,255,.15), transparent 40%), var(--bg);
      color: #fff;
      font-family: 'Inter', sans-serif;
    }
    .glass {
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border: 1px solid rgba(255,255,255,.08);
      box-shadow: 0 10px 40px rgba(0,0,0,.35);
    }
    .btn {
      background: linear-gradient(135deg,#6366F1,#8B5CF6);
      border-radius: 999px;
      font-weight: 600;
      transition: 0.2s;
    }
    .btn:hover { opacity: .9; transform: translateY(-1px); }
    .danger { background: linear-gradient(135deg,#ff4d4d,#e11d48); }
    .info { color: var(--violet); }
  </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center p-6">

  <div class="glass rounded-2xl p-6 w-full max-w-md text-center">
    <img id="userPhoto" class="w-20 h-20 rounded-full mx-auto mb-3 object-cover border border-white/20" alt="Photo de profil">
    <h2 id="userName" class="text-2xl font-bold mb-1">Chargement...</h2>
    <p id="userEmail" class="text-white/70 text-sm mb-4"></p>

    <div class="space-y-2 mb-6">
      <p class="text-sm"><span class="info">UID :</span> <span id="userUid" class="text-white/70"></span></p>
      <p class="text-sm"><span class="info">Créé le :</span> <span id="userCreated" class="text-white/70"></span></p>
    </div>

    <button id="logoutBtn" class="btn px-5 py-2.5 w-full">Se déconnecter</button>
    <button id="deleteBtn" class="btn danger px-5 py-2.5 w-full mt-3">Supprimer mon compte</button>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getAuth, onAuthStateChanged, signOut, deleteUser } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCoR8lWMJbB0Pgr-F86v3hwWlX4XT3TQ1k",
      authDomain: "mhd-pronos.firebaseapp.com",
      projectId: "mhd-pronos",
      storageBucket: "mhd-pronos.firebasestorage.app",
      messagingSenderId: "366441954219",
      appId: "1:366441954219:web:a8be6641c5c922c59cf0ee"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    const userPhoto = document.getElementById("userPhoto");
    const userName = document.getElementById("userName");
    const userEmail = document.getElementById("userEmail");
    const userUid = document.getElementById("userUid");
    const userCreated = document.getElementById("userCreated");
    const logoutBtn = document.getElementById("logoutBtn");
    const deleteBtn = document.getElementById("deleteBtn");

    onAuthStateChanged(auth, (user) => {
      if (!user) {
        window.location.href = "index.html";
      } else {
        userPhoto.src = user.photoURL || "https://www.gravatar.com/avatar/?d=mp";
        userName.textContent = user.displayName || "Utilisateur";
        userEmail.textContent = user.email;
        userUid.textContent = user.uid;
        userCreated.textContent = new Date(user.metadata.creationTime).toLocaleString("fr-FR");
      }
    });

    logoutBtn.addEventListener("click", async () => {
      await signOut(auth);
      window.location.href = "index.html";
    });

    deleteBtn.addEventListener("click", async () => {
      const confirmDel = confirm("⚠️ Voulez-vous vraiment supprimer votre compte ? Cette action est irréversible.");
      if (confirmDel) {
        const user = auth.currentUser;
        try {
          await deleteUser(user);
          alert("Compte supprimé avec succès !");
          window.location.href = "index.html";
        } catch (err) {
          alert("Erreur : " + err.message);
        }
      }
    });
  </script>

</body>
</html>
