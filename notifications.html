<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Notifications - MHD Pronos</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      background: linear-gradient(135deg, #0f172a, #1e293b);
      color: #fff;
      font-family: 'Segoe UI', sans-serif;
      min-height: 100vh;
    }
    .notification-card {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 1rem;
      padding: 1.5rem;
      margin-bottom: 1rem;
      transition: transform 0.2s ease, box-shadow 0.3s ease;
    }
    .notification-card:hover {
      transform: translateY(-4px);
      box-shadow: 0px 6px 20px rgba(0, 0, 0, 0.4);
    }
    .badge-new {
      background-color: #10B981;
      color: white;
      padding: 0.25rem 0.6rem;
      font-size: 0.75rem;
      border-radius: 9999px;
      margin-left: 0.5rem;
    }
  </style>
</head>
<body>

  <!-- HEADER -->
  <header class="text-center py-6">
    <h1 class="text-4xl font-extrabold text-blue-400">NOTIFICATIONS</h1>
    <p class="text-gray-400 mt-2">Restez inform√© des derni√®res nouvelles et mises √† jour. Inscrivez-vous avec le code promo <strong>AXEX</strong> et gagnez jusqu'√† <strong>169.000F</strong></p>
  </header>

  <!-- BOUTONS DE NAVIGATION -->
  <nav class="flex flex-wrap justify-center gap-3 mb-8">
    <a href="index.html" class="bg-blue-600 hover:bg-blue-700 px-5 py-2 rounded-lg">ACCUEIL</a>
    <a href="astuce.html" class="bg-blue-600 hover:bg-blue-700 px-5 py-2 rounded-lg requires-auth">ASTUCES</a>
    <a href="vip.html" class="bg-blue-600 hover:bg-blue-700 px-5 py-2 rounded-lg requires-auth">VIP</a>
    <a href="victoires.html" class="bg-blue-600 hover:bg-blue-700 px-5 py-2 rounded-lg">VICTOIRES</a>
  </nav>

  <!-- BOUTON ACTUALISER -->
  <div class="text-center mb-6">
    <button onclick="loadNotifications()" class="bg-green-600 hover:bg-green-700 px-6 py-2 rounded-lg font-semibold">ACTUALISER LES NOTIFICATIONS</button>
  </div>

  <!-- LISTE DES NOTIFICATIONS -->
  <main class="max-w-3xl mx-auto px-4" id="notificationsContainer">
    <p class="text-center text-gray-400">Chargement des notifications...</p>
  </main>

  <!-- PARTENAIRES -->
  <section class="text-center mt-16">
    <h2 class="text-2xl font-bold text-blue-400 mb-6">NOS PARTENAIRES</h2>
    <div class="flex flex-wrap justify-center gap-3">
      <a href="https://bit.ly/1xbetins_mhd_axex" target="_blank" class="bg-indigo-600 px-4 py-2 rounded-lg">1XBET</a>
      <a href="https://bwredir.com/1Xxd?p=%2Fregistration%2F" target="_blank" class="bg-indigo-600 px-4 py-2 rounded-lg">BETWINNER</a>
      <a href="https://1wyvrz.life/?p=vteh" target="_blank" class="bg-indigo-600 px-4 py-2 rounded-lg">1WIN</a>
      <a href="https://refpa3665.com/L?tag=d_2526373m_45415c_&site=2526373&ad=45415" target="_blank" class="bg-indigo-600 px-4 py-2 rounded-lg">MELBET</a>
      <a href="https://top100bonus.com/L?tag=d_2625843m_37513c_&site=2625843&ad=37513" target="_blank" class="bg-indigo-600 px-4 py-2 rounded-lg">888STARZ</a>
      <a href="https://combodef.com/L?tag=d_3703799m_60651c_&site=3703799&ad=60651" target="_blank" class="bg-indigo-600 px-4 py-2 rounded-lg">PARIPESA</a>
      <a href="https://gpaff.top/L?tag=d_3453290m_69627c_&site=3453290&ad=69627" target="_blank" class="bg-indigo-600 px-4 py-2 rounded-lg">GOLDPARI</a>
      <a href="https://refpazitag.top/L?tag=d_2561833m_25437c_&site=2561833&ad=25437" target="_blank" class="bg-indigo-600 px-4 py-2 rounded-lg">MEGAPARI</a>
      <a href="https://lb-aff.com/L?tag=d_2378251m_22611c_&site=2378251&ad=22611" target="_blank" class="bg-indigo-600 px-4 py-2 rounded-lg">LINEBET</a>
    </div>
  </section>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getFirestore, collection, query, orderBy, getDocs } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCoR8lWMJbB0Pgr-F86v3hwWlX4XT3TQ1k",
      authDomain: "mhd-pronos.firebaseapp.com",
      projectId: "mhd-pronos",
      storageBucket: "mhd-pronos.firebasestorage.app",
      messagingSenderId: "366441954219",
      appId: "1:366441954219:web:a8be6641c5c922c59cf0ee"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    async function loadNotifications() {
      const container = document.getElementById("notificationsContainer");
      container.innerHTML = "<p class='text-center text-gray-400'>Chargement des notifications...</p>";

      const q = query(collection(db, "notifications"), orderBy("date", "desc"));
      const querySnapshot = await getDocs(q);

      if (querySnapshot.empty) {
        container.innerHTML = "<p class='text-center text-gray-500'>Aucune notification pour le moment.</p>";
        return;
      }

      container.innerHTML = "";
      const now = Date.now();

      querySnapshot.forEach((doc) => {
        const data = doc.data();
        const diffHeures = (now - data.date.toMillis()) / (1000 * 60 * 60);
        const isNew = diffHeures < 24; // üÜï badge si moins de 24h

        container.innerHTML += `
          <div class="notification-card">
            <div class="flex items-center justify-between mb-2">
              <h3 class="text-xl font-semibold">${data.titre} ${isNew ? "<span class='badge-new'>Nouveau</span>" : ""}</h3>
              <span class="text-sm text-gray-400">${new Date(data.date.toMillis()).toLocaleString()}</span>
            </div>
            <p class="text-gray-300 mb-2">${data.message}</p>
            ${data.lien ? `<a href="${data.lien}" target="_blank" class="text-blue-400 hover:underline">Voir plus</a>` : ""}
          </div>
        `;
      });
    }

    loadNotifications();
  </script>
  <script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
  import { getFirestore, collection, getDocs, doc, updateDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyCoR8lWMJbB0Pgr-F86v3hwWlX4XT3TQ1k",
    authDomain: "mhd-pronos.firebaseapp.com",
    projectId: "mhd-pronos",
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  async function marquerToutesCommeLues() {
    const querySnapshot = await getDocs(collection(db, "notifications"));
    querySnapshot.forEach(async (notif) => {
      await updateDoc(doc(db, "notifications", notif.id), { lu: true });
    });
  }

  marquerToutesCommeLues();
</script>
  <script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, onSnapshot } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyCoR8lWMJbB0Pgr-F86v3hwWlX4XT3TQ1k",
  authDomain: "mhd-pronos.firebaseapp.com",
  projectId: "mhd-pronos",
  storageBucket: "mhd-pronos.firebasestorage.app",
  messagingSenderId: "366441954219",
  appId: "1:366441954219:web:a8be6641c5c922c59cf0ee"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

// üîä Charge le son de notification
const sound = new Audio("sounds/notification.mp3");

let previousCount = 0;

// üß© Surveille en temps r√©el la collection "notifications"
onSnapshot(collection(db, "notifications"), (snapshot) => {
  const currentCount = snapshot.docs.length;

  if (previousCount && currentCount > previousCount) {
    // üÜï Nouvelle notification d√©tect√©e ‚Üí joue le son
    sound.play().catch(() => {
      console.warn("L'utilisateur doit interagir une fois avec le site avant que le son puisse jouer.");
    });
  }

  previousCount = currentCount;
});
</script>
<!-- MODALE D‚ÄôACC√àS PROT√âG√â -->
<style>
  .modal-auth{position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;place-items:center;z-index:100;}
  .modal-auth.open{display:grid}
  .modal-card{background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
    border:1px solid rgba(255,255,255,.12);border-radius:1rem;max-width:520px;width:92%;box-shadow:0 10px 40px rgba(0,0,0,.35)}
</style>

<div id="authModal" class="modal-auth">
  <div class="modal-card p-5">
    <div class="flex items-start justify-between gap-4 border-b border-white/10 pb-3">
      <div>
        <h3 class="text-xl font-bold">Connexion requise</h3>
        <p class="text-sm text-white/70">Pour acc√©der √† cette section (VIP, Astuces, Conseils, Foot News, Profil), veuillez vous connecter ou cr√©er un compte.</p>
      </div>
      <button id="authClose" class="pill px-3 py-1.5 rounded-lg">Fermer</button>
    </div>

    <div class="mt-4 text-sm text-white/80">
      <ul class="list-disc ml-5 space-y-1">
        <li>Acc√®s s√©curis√© avec Firebase Auth</li>
        <li>Redirection automatique vers la page choisie apr√®s connexion</li>
      </ul>
    </div>

    <div class="mt-5 grid grid-cols-1 sm:grid-cols-2 gap-3">
      <a id="goLogin" href="connexion.html" class="btn-primary px-4 py-2 rounded-xl text-center font-semibold">Se connecter</a>
      <a id="goSignup" href="inscription.html" class="px-4 py-2 rounded-xl text-center font-semibold"
         style="background:linear-gradient(135deg,#10B981,#34D399);border:1px solid rgba(255,255,255,.12);">Cr√©er un compte</a>
    </div>

    <div class="mt-4 text-xs text-white/60">
      En vous connectant, vous acceptez nos conditions d‚Äôutilisation.
    </div>
  </div>
</div>
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

  // ‚öôÔ∏è CONFIG FIREBASE (identique aux autres pages)
  const firebaseConfig = {
    apiKey: "AIzaSyCoR8lWMJbB0Pgr-F86v3hwWlX4XT3TQ1k",
    authDomain: "mhd-pronos.firebaseapp.com",
    projectId: "mhd-pronos",
    storageBucket: "mhd-pronos.firebasestorage.app",
    messagingSenderId: "366441954219",
    appId: "1:366441954219:web:a8be6641c5c922c59cf0ee"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);

  // R√©f√©rences modale
  const modal = document.getElementById('authModal');
  const btnClose = document.getElementById('authClose');
  const btnLogin = document.getElementById('goLogin');
  const btnSignup = document.getElementById('goSignup');

  // Retient vers o√π on voulait aller
  let pendingTarget = null;

  // Ouvre/ferme modale
  function openModal(){ modal.classList.add('open'); }
  function closeModal(){ modal.classList.remove('open'); pendingTarget = null; }

  btnClose.addEventListener('click', closeModal);

  // Ajoute ?redirect=<url> aux liens login/inscription
  function updateAuthLinks(targetHref){
    const enc = encodeURIComponent(targetHref);
    btnLogin.href  = `connexion.html?redirect=${enc}`;
    btnSignup.href = `inscription.html?redirect=${enc}`;
  }

  // Intercepteur sur tous les liens prot√©g√©s
  function wireAuthGuards(user){
    document.querySelectorAll('a.requires-auth').forEach(a=>{
      a.addEventListener('click', (e)=>{
        const href = a.getAttribute('href') || '#';
        if(user){ return; } // utilisateur connect√© : laisser passer
        e.preventDefault();
        pendingTarget = href;
        updateAuthLinks(href);
        // En plus, on garde dans sessionStorage au cas o√π
        sessionStorage.setItem('postLoginRedirect', href);
        openModal();
      }, { capture:true });
    });
  }

  // D√®s que l‚Äô√©tat change, rec√¢ble les gardes
  onAuthStateChanged(auth, (user)=>{
    wireAuthGuards(user);
  });
</script>

</body>
</html>
